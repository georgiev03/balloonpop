{"version":3,"file":"mobile-9chSxeQl.js","sources":["../../src/orientation-handler.js","../../mobile.html?html-proxy&index=1.js"],"sourcesContent":["// Orientation and fullscreen handler for mobile devices\r\nclass OrientationHandler {\r\n    constructor(containerId = 'game-container') {\r\n        this.container = document.getElementById(containerId);\r\n        this.isFullscreen = false;\r\n        this.setupEventListeners();\r\n    }\r\n\r\n    setupEventListeners() {\r\n        // Listen for orientation changes\r\n        if (screen.orientation) {\r\n            screen.orientation.addEventListener('change', () => this.handleOrientationChange());\r\n        } else {\r\n            window.addEventListener('orientationchange', () => this.handleOrientationChange());\r\n        }\r\n\r\n        // Fallback resize listener\r\n        window.addEventListener('resize', () => this.handleResize());\r\n\r\n        // Handle fullscreen changes\r\n        document.addEventListener('fullscreenchange', () => this.handleFullscreenChange());\r\n        document.addEventListener('webkitfullscreenchange', () => this.handleFullscreenChange());\r\n        document.addEventListener('mozfullscreenchange', () => this.handleFullscreenChange());\r\n        document.addEventListener('MSFullscreenChange', () => this.handleFullscreenChange());\r\n\r\n        // Initial check\r\n        this.checkOrientation();\r\n    }\r\n\r\n    async handleOrientationChange() {\r\n        // Small delay to allow orientation change to complete\r\n        await new Promise(resolve => setTimeout(resolve, 100));\r\n        this.checkOrientation();\r\n    }\r\n\r\n    handleResize() {\r\n        // Use resize as a fallback for orientation detection\r\n        this.checkOrientation();\r\n    }\r\n\r\n    async checkOrientation() {\r\n        const isLandscape = this.isLandscapeMode();\r\n        \r\n        if (isLandscape && !this.isFullscreen) {\r\n            await this.enterFullscreen();\r\n        }\r\n    }\r\n\r\n    isLandscapeMode() {\r\n        if (screen.orientation) {\r\n            return screen.orientation.type.includes('landscape');\r\n        } else if (window.orientation !== undefined) {\r\n            return Math.abs(window.orientation) === 90;\r\n        }\r\n        // Fallback to window dimensions\r\n        return window.innerWidth > window.innerHeight;\r\n    }\r\n\r\n    async requestFullscreen() {\r\n        return this.enterFullscreen();\r\n    }\r\n\r\n    async enterFullscreen() {\r\n        if (!document.fullscreenElement) {\r\n            try {\r\n                const element = this.container || document.documentElement;\r\n                if (element.requestFullscreen) {\r\n                    await element.requestFullscreen();\r\n                } else if (element.webkitRequestFullscreen) {\r\n                    await element.webkitRequestFullscreen();\r\n                } else if (element.mozRequestFullScreen) {\r\n                    await element.mozRequestFullScreen();\r\n                } else if (element.msRequestFullscreen) {\r\n                    await element.msRequestFullscreen();\r\n                }\r\n                this.isFullscreen = true;\r\n                return true;\r\n            } catch (error) {\r\n                console.warn('Fullscreen request failed:', error);\r\n                return false;\r\n            }\r\n        }\r\n        return true;\r\n    }\r\n\r\n    exitFullscreen() {\r\n        if (document.fullscreenElement) {\r\n            if (document.exitFullscreen) {\r\n                document.exitFullscreen();\r\n            } else if (document.webkitExitFullscreen) {\r\n                document.webkitExitFullscreen();\r\n            } else if (document.mozCancelFullScreen) {\r\n                document.mozCancelFullScreen();\r\n            } else if (document.msExitFullscreen) {\r\n                document.msExitFullscreen();\r\n            }\r\n        }\r\n        this.isFullscreen = false;\r\n    }\r\n\r\n    handleFullscreenChange() {\r\n        this.isFullscreen = !!document.fullscreenElement;\r\n        // Dispatch custom event for game to handle\r\n        const event = new CustomEvent('fullscreenchange', {\r\n            detail: { isFullscreen: this.isFullscreen }\r\n        });\r\n        window.dispatchEvent(event);\r\n    }\r\n}\r\n\r\n// Export the handler\r\nexport default OrientationHandler; ","\n        function preventDefault(e) {\n            e.preventDefault();\n        }\n\n        document.addEventListener('touchmove', preventDefault, { passive: false });\n        document.addEventListener('touchstart', preventDefault, { passive: false });\n        document.addEventListener('touchend', preventDefault, { passive: false });\n        document.addEventListener('scroll', preventDefault, { passive: false });\n        document.addEventListener('wheel', preventDefault, { passive: false });\n\n        let lastTouchEnd = 0;\n        document.addEventListener('touchend', (e) => {\n            const now = Date.now();\n            if (now - lastTouchEnd <= 300) {\n                e.preventDefault();\n            }\n            lastTouchEnd = now;\n        }, { passive: false });\n\n        if (screen.orientation && screen.orientation.lock) {\n            try {\n                screen.orientation.lock('landscape');\n            } catch (err) {\n                console.log('Orientation lock not supported');\n            }\n        }\n\n        import OrientationHandler from './src/orientation-handler.js';\n        \n        const orientationHandler = new OrientationHandler('game-container');\n        const rotationPrompt = document.getElementById('rotation-prompt');\n        const installPrompt = document.getElementById('install-prompt');\n        const installButton = document.getElementById('install-button');\n        let deferredPrompt;\n\n        window.addEventListener('beforeinstallprompt', (e) => {\n            e.preventDefault();\n            deferredPrompt = e;\n            installPrompt.style.display = 'block';\n        });\n\n        installButton.addEventListener('click', async () => {\n            if (deferredPrompt) {\n                deferredPrompt.prompt();\n                const { outcome } = await deferredPrompt.userChoice;\n                if (outcome === 'accepted') {\n                    installPrompt.style.display = 'none';\n                }\n                deferredPrompt = null;\n            }\n        });\n\n        if ('serviceWorker' in navigator) {\n            window.addEventListener('load', () => {\n                navigator.serviceWorker.register('/sw.js')\n                    .then(registration => {\n                        console.log('ServiceWorker registration successful');\n                    })\n                    .catch(err => {\n                        console.log('ServiceWorker registration failed: ', err);\n                    });\n            });\n        }\n\n        function checkOrientation() {\n            if (window.innerWidth > window.innerHeight) {\n                rotationPrompt.style.display = 'none';\n            } else {\n                rotationPrompt.style.display = 'flex';\n            }\n        }\n\n        window.addEventListener('resize', checkOrientation);\n        window.addEventListener('orientationchange', () => {\n            setTimeout(checkOrientation, 100);\n        });\n\n        checkOrientation();\n\n        const script = document.createElement('script');\n        script.src = 'dist/bundle.js';\n        script.type = 'module';\n        document.body.appendChild(script);\n    "],"names":["OrientationHandler","containerId","resolve","element","error","event","preventDefault","e","lastTouchEnd","now","rotationPrompt","installPrompt","installButton","deferredPrompt","outcome","registration","err","checkOrientation","script"],"mappings":"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"}